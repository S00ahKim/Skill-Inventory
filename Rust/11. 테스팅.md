# 테스팅

## 테스트를 작성하는 방법
- 테스트?
    * 테스트 아닌 코드가 프로그램 내에서 기대했던 대로 기능을 하는지 검증하는 러스트 함수
    * test 속성(attribute)이 주석으로 달려진 (annotated) 함수
- 테스트가 하는 일
    * 필요한 데이터 혹은 상태를 설정하기
    * 우리가 테스트하고 싶은 코드를 실행하기
    * 그 결과가 우리 예상대로인지 단언하기(assert)


## 테스트 실행하기
- `cargo test`는 코드를 테스트 모드에서 컴파일하고 결과로 발생한 테스트 바이너리를 실행함
- 여러 개의 테스트를 실행할 때는, 기본적으로 스레드를 이용하여 병렬적으로 수행함. 병렬로 실행하기 싫다면 스레드 수를 1로 고정할 수 있음.
- 성공하는 테스트에 대한 출력 값 또한 보게 하려면 `--nocapture` 플래그를 이용
- 테스트 함수의 이름을 넘겨서 특정 테스트만 실행 가능
- `#[ignore]`를 붙여서 원치 않는 테스트를 무시할 수 있음


## 테스트 조직화
- 단위 테스트
    * 각 코드의 단위를 나머지 부분과 분리하여 테스트 (한 번에 하나의 모듈만 분리)
    * 작고 하나에 더 집중
    * 비공개 인터페이스 (private interface)를 테스트
    * 코드가 어디 있고 어느 부분이 기대한 대로 동작하지 않는지를 빠르게 정확히 찾아낼 수 있도록 하기 위함
    * 단위 테스트는 src 디렉토리 내에 넣음. 각 파일마다 테스트하는 코드를 담음.
    * 관례? 각 파일마다 테스트 함수를 담고 있는 tests라는 이름의 모듈을 만들고, 이 모듈에 cfg(test)라고 어노테이션 하는 것
- 통합 테스트
    * 완전히 라이브러리 외부에 있음
    * 공개 인터페이스 (public interface)를 이용
    * 다른 외부 코드가 하듯이, 테스트마다 여러 개의 모듈을 잠재적으로 실험함
    * 오직 라이브러리의 공개 API 부분에 속하는 함수들만 호출할 수 있음
    * 라이브러리의 수많은 파트들이 함께 올바르게 동작하는지를 시험하기 위함 (그 자체로서는 올바르게 동작하는 코드의 단위들도 통합되었을 때는 문제를 일으킬 수 있으므로)
    * 관례? tests 디렉토리를 만듦