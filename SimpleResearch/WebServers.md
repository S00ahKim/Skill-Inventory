# Web Servers
## 웹 서버와 웹 애플리케이션 서버
1. 웹 서버 (WS)
- 정의: HTTP를 통해 웹 브라우저에서 요청하는 HTML 문서나 오브젝트(이미지 파일 등)을 전송해주는 서비스 프로그램, 또는 그를 구동하는 하드웨어

2. 웹 애플리케이션 서버 (WAS)
- 정의: 웹 애플리케이션과 서버 환경을 만들어 동작시키는 기능을 제공하는 소프트웨어 프레임워크. HTTP를 통해 사용자 컴퓨터나 장치에 애플리케이션을 수행해 주는 미들웨어.
- 웹 서버와의 차이? 
    * 웹서버: 불려진 파일을 전송. 정적인 컨텐츠(html, css, js etc.) `ex. Apache, Nginx`
    * 웹 애플리케이션 서버: 페이지를 구성(DB조회, 로직 처리 등)하여 만들어진 파일을 전송. 웹 서버 + 웹 컨테이너 `ex. Tomcat, Jeus`

3. 두 가지 타입의 서버를 필요로 하는 이유
- WAS도 정적 컨텐츠를 제공할 수 있지만, 많은 경우 웹서버를 앞단에, WAS를 뒷단에 둔다.
- 왜? 효율적인 자원 이용, 장애 대응, 배포와 유지보수 용이성 등
    * 부하 분산
        + 서버 간 역할을 나누어 WAS가 해야 할 일의 부담을 줄이기 위해. 
        + 즉, 정적 데이터 처리로 인한 지연으로 처리 속도가 저하되는 것을 방지하기 위함.
        + 여러 대의 WAS를 사용한다면, 플러그인 형태로 설정하여 분산 처리 가능.
    * WAS의 설정 파일을 외부에 노출하지 않기 위해 (보안 강화)


## Apache HTTP Server
- 개발: 아파치 소프트웨어 재단
- 특징
    * 확장성, 호환성, 이식성, 안정성 높음. `모듈` 개념으로 기능을 쉽게 덧붙일 수 있다.
    * 2.2 버전부터 무겁다는 평
- 구조
    * 요청 당 프로세스 또는 쓰레드가 처리하는 구조. 각 요청마다 새로운 쓰레드 필요.
    * 그래서 요청이 많아지면 CPU와 메모리 사용량이 높아져 성능이 저하 가능성이 있음.
    * MPM(Multi Processing Module) 구조를 기반으로 클라이언트 요청 처리 방법을 처리
    * MPM? 
        + mpm_prefork: 단일 스레드 로직에서 동작하며 각 서버 프로세스는 한 번에 하나의 웹 요청(Web Request)을 처리한다. PHP 환경에서 권장.
        + mpm_worker: 동시에 여러 스레드를 지원. (좀 더 효율적이고 확장 가능하도록 함)
        + mpm_event: mpm_worker와 유사한 방식으로 동작 + Keep Alive 메커니즘 포함 (커넥션마다 새로운 스레드가 필요하다는 관점에서 커넥션이 대규모로 많아질 때 성능 측면에서 많은 이슈가 발생할 수 있다.)
- CGI (Common Gateway Interface)
    * 웹 서버 상에서 사용자 프로그램을 동작시키기 위한 조합
    * 일종의 인터페이스로서, 웹 서버 상에서 프로그램을 동작시키기 위한 방법을 정의한 프로그램 또는 스크립트
    * JAVA에서 Apache + Tomcat 조합을 쓰는 것처럼, PHP, Perl, Python 등의 언어들은 CGI를 구현하여 아파치에서 각 프로그램을 실행할 수 있게 함 `ex. python uwsgi`

## Nginx
- 개발: 러시아 lgor Sysoev (2004)
- 특징
    * 빠르다. 개선된 아파치 2.4보다도 미세하게 성능이 좋다.
    * 중앙 집중식 구성: 아파치는 추가 구성을 하는 데 용이하지만, 엔진엑스는 불가. 그러나 가상화/클라우드/MSA 등의 구조에서 경량화 및 성능 보장이라는 장점이 되기도 함.
    * 아파치는 서버 내에서 동적 컨텐츠를 처리하지만, 엔진엑스는 동적 컨텐츠 관련 요청은 외부 자원과 연계(php-fpm)한다. 동적 컨텐츠 서빙을 위해 대기함.
    * 아파치가 지원하는 OS를 거의 지원하지만, 엔진엑스는 윈도우의 경우 부분 지원한다.
- 구조
    * 비동기 Event Driven 구조. (단일 엔진엑스 worker(쓰레드)가 동시에 수천개의 요청 처리 가능)
        + 적은 수의 쓰레드를 사용하므로, 할당되는 메모리도 적고, 컨텍스트 스위칭 비용이 적고, 따라서 CPU 소모도 적음.
    * 이벤트가 트리거될 때, 요청에 state를 부여하고, 새로운 요청을 빠르게 처리할 수 있는 내부 루핑 시스템 사용.
    * 이벤트가 대기할 필요가 없기 때문에 아파치보다 빠르다. (이벤트 처리, 비동기식, 논블로킹)


## Tomcat
- 개발: 아파치 소프트웨어 재단 (2005~)
- 역할: JSP, 서블릿 처리, HTTP 요청 수신 및 응답
- 특징
    * 웹 서버와 웹 컨테이너 기능 제공
        + 웹 컨테이너? 클라이언트의 요청이 있을 때, 내부의 프로그램을 통해 결과를 만들어내고 이것을 다시 클라이언트에게 전달
        + 톰캣은 서블릿과 JSP를 위한 런타임 환경을 제공함.
        + 하지만, JAVA EE (EJB, JMS, CDI, JTA, 서블릿 API)를 지원하지 않기 때문에 명확한 의미의 WAS라고 보기엔 어려움.
        + EJB? Enterprise Java Bean. 트랜잭션 등 엔터프라이즈 (기업) 환경에서 사용하는 컴포넌트 기술.
    * 동적인 데이터를 처리할 수 있게 함 (DB 연결, 데이터 조작, 타 응용 프로그램과의 상호작용 등)
    * 정적 컨텐츠 서빙도 가능(5.5~, Apache Tomcat)하지만, 아파치가 톰캣보다 조금 더 효율적으로 제공한다.


## 참고자료
- 위키피디아
- [Difference between an application server and a servlet container?](https://stackoverflow.com/questions/5039354/difference-between-an-application-server-and-a-servlet-container)