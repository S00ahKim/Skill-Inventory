#### 바로가기
- [Cache](#cache)
  - [적중과 부적중](#적중과-부적중)
  - [캐시 토폴로지](#캐시-토폴로지)
  - [캐시 처리단계](#캐시-처리단계)
  - [사본을 신선하게 유지하기](#사본을-신선하게-유지하기)
  - [캐시 제어](#캐시-제어)
  - [캐시 제어 설정](#캐시-제어-설정)
  - [자세한 알고리즘](#자세한-알고리즘)
  - [캐시와 광고](#캐시와-광고)
  - [추가 정보](#추가-정보)

---

# Cache
- 웹 캐시: 자주 쓰이는 문서의 사본을 자동으로 보관하는 HTTP 장치
- 장점
    * 불필요한 데이터 전송 줄임 -> 네트워크 비용 감소
        + 똑같은 바이트들이 네트워크를 통해 계속 반복 이동
        + 값비싼 네트워크 대역폭을 낭비 & 전송 속도 저하 & 웹 서버에 부하를 줌
        + 캐시 사용 시, 첫 번째 서버 응답은 캐시에 보관되며, 캐시된 사본이 그 뒤 요청에 대해 응답함
    * 네트워크 병목 감소 / 대역폭 늘리지 않고도 페이지의 빠른 로드 가능
        + 원격 서버보다 로컬 네트워크에 더 넓은 대역폭을 제공
            - (캐시 미사용) 서버 접근 속도 = 경로에 있는 가장 느린 네트워크 속도
            - (캐시 사용) LAN에 있는 캐시로부터 사본 가져옴 -> 성능 대폭 개선
        + 대역폭: 네트워크 속도와 문서 크기에 따라 **전송 시간**에 영향을 많이 줌
    * 원 서버에 대한 요청을 줄임 -> 서버는 부하를 줄일 수 있음 & 더 빠르게 응답 가능
        + 속보, 스팸, 특정 사건 등으로 트래픽이 급증할 경우(Flash Crowds), 서버에 과부하를 줄 수 있음
    * 거리로 인한 지연 감소
        + 원거리 요청이 가지는 어쩔 수 없는 지연: 모든 라우터 각각에서 발생하는 지연 & 빛의 속도 자체로 지연
- point
    * 어떻게 캐시가 성능을 개선하고 비용을 줄이나? 
    * 어떻게 그 효과를 측정하는가?
    * 캐시를 어디에 위치시켜야 한느가?
    * HTTP가 어떻게 캐시된 사본을 fresh하게 유지하는가?
    * 캐시는 어떻게 다른 캐시/서버와 상호작용하는가?


## 적중과 부적중
- 적중(hit): 캐시에 저장된 사본으로 요청이 처리됨
- 부적중(miss): 대응하는 사본이 없어 원 서버로 요청이 전달됨
- 재검사(revalidation): 캐시에 저장된 사본이 최신인지 점검하는 것 (=신선도 검사)
    * 충분히 오래된 경우에만 재검사
        + [재검사 규칙](#사본을-신선하게-유지하기)
        + `If-Modified-Since` 헤더를 추가하여 GET 요청을 보내면, 캐시된 시간 이후 변경됐을 때만 사본을 보내달라는 의미. 
        + 응답으로는 적중/부적중/삭제가 올 수 있음.
    * 재검사 적중/느린 적중
        + 304 Not Modified
        + 재검사 후 변경이 없음을 확인하고 응답하는 경우
        + 부적중보다 빠르고 적중보다 느림
    * 재검사 부적중
        + 200 OK & 콘텐츠 전체
        + 일반 부적중과 거의 같은 속도로 수행
    * 객체 삭제
        + 404 Not Found
        + 캐시는 사본을 삭제함
- 캐시/문서 적중률/적중비
    * 0~1, 1이 all 적중, 0.4면 좋은 편
    * 얼마나 많은 트랜잭션을 외부로 내보내지 않았는가
    * 전체 대기 시간이 줄어듦
- 바이트 적중률
    * 트래픽의 바이트 단위로 요금이 산정될 경우 유용. 트래픽이 절감된 정도를 포착함.
    * 얼마나 많은 바이트가 인터넷으로 나가지 않았는가
    * 대역폭 절약 최적화
- 적중/부적중의 구별: HTTP가 응답에 이를 명시하는 것은 **없음**
    * 응답의 Date 헤더를 현재 시각과 비교 -> 생성일이 오래되었음 -> 캐시된 응답
    * 응답이 얼마나 오래된 것인지를 말하는 Age 헤더 이용


## 캐시 토폴로지

## 캐시 처리단계

## 사본을 신선하게 유지하기

## 캐시 제어

## 캐시 제어 설정

## 자세한 알고리즘

## 캐시와 광고

## 추가 정보